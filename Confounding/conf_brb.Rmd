---
title: Arztbesuche und Managed Care
subtitle: Eine Analyse anhand von Administrativdaten.
output: pdf_document
classoption: a4paper
lang:  de-CH
toc: true
header-includes:
- \usepackage{fancyhdr}
- \pagestyle{fancy}
- \fancyhead{}
- \renewcommand{\headrulewidth}{0pt}
- \fancyfoot[C]{Arztbesuche und Managed Care}
- \fancyfoot[LE,RO]{\thepage}
documentclass: article
bibliography: bebru.bib
---

```{r setup, echo=FALSE, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
source("init.R")
```


```{r init, include=FALSE, autodep=TRUE}
source("data.R")
```

# Einführung

Die steigenden Kosten im Gesundheitswesen bereiten sowohl national als auch international Sorgen (@edi_gesundheit_2013, @thomson_financing_2009). Vorschläge für Möglichkeiten, um diesen Anstieg zumindest zu dämpfen, gibt es wenige. Einer davon ist eine verbesserte Koordination der Patienten durch Gatekeeper (z.B. Hausärzte). In der Schweiz fördern sogenannte Managed Care (MC) Modelle in der obligatorischen Grundversicherung (OKP) diese Koordination durch finanzielle Anreize. Dabei nehmen die Versicherten in Kauf, dass die Auswahl an Leistungserbringern von ihren Krankenversicherungen eingeschränkt wird. Im Gegenzug erhalten sie einen Rabatt auf ihre Krankenversicherungsprämien, da bisherige Studien davon ausgehen, dass diese Restriktionen zu tieferen Kosten führen (z.B. @reich_empirical_2012, @kauer_long-term_2016).  

## Fragestellung

In dieser Analyse soll untersucht werden, wie sich die Restriktionen von MC auf die Inanspruchnahme des Gesundheitswesens auswirken. Eine solche Senkung der Inanspruchnahme ist eine mögliche Erklärung für die festgestellten Kosteneinsparungen (eine andere sind beisüielsweise effizientere Behandlungen).  

## Operationalisierung

### Zielgrösse

@berchtold_evidenz_2006 haben in einer Literaturanalyse festgestellt, dass die Kosteneinsparungen in MC möglicherweise mit einer tieferen Anzahl an Arztbesuchen zusammenhängen. In dieser Analyse soll deshalb als Messgrösse für die Inanspruchnahme des Gesundheitswesens die Anzahl Arztbesuche verwendet werden.    
Die Anzahl Arztbesuche decken nur einen Teil der Inanspruchnahme des Gesundheitswesens ab. Allerdings einen gewichtigen, welcher beispielsweise durch Zuweisungen zu weiteren Ärzten oder Verschreibungen von Medikamenten zu weiteren Kosten führen kann.

> **Hypothese:** Versicherte in Managed Care Modellen weisen eine reduzierte Anzahl Arztbesuche pro Jahr auf.

### Einflussgrössen

Die Zielgrösse wird durch verschiedene Einflussgrössen beeinflusst, welche in der Analyse mitberücksichtigt werden sollen. Die hier aufgeführten Einflussgrössen werden auch in @reich_empirical_2012 und @kauer_long-term_2016 verwendet (Tabelle \ref{tab:tbl.predictors}). Detailierte Begründungen dafür sind dort verfügbar.

```{r tbl.predictors, echo=FALSE}
tbl.predictors <- 
  tribble(
    ~"Einflussgrösse", ~Operationalisierung,
    "Gesundheitszustand", "Alter, Franchisestufe, Unfall-Deckung in der OKP, Anzahl chronische Erkrankungen",
    "Persönliche Einstellung", "Geschlecht, Alter, Franchisestufe",
    "Kulturelle Einstellung", "Sprachgebiet, Wohnumgebung (Stadt/Land), Wohnregion"
  )
pander(tbl.predictors, caption="\\label{tbl:tbl.predictors}Operationalisierung der Einflussgrössen")
```


# Methoden

## Datenbasis

Die Datenbasis besteht aus zur administrativen Verwendung erhobenen Daten der Krankenversicherungsgruppe Helsana. Versicherte von Helsana schicken ihre Rechnungen der Leistungserbringer zur Vergütung ein, wo sie zur elektronischen Verarbeitung in einer Datenbank gespeichert werden. Diese Datenbank beinhaltet jede eingesandte Rechnung bis zur Granularität der einzelnen Rechnungspositionen. Die Daten dürfen für wissenschaftliche Zwecke verwendet werden, da Krankenversicherer bundesnahe Betriebe sind. Voraussetzung ist, dass die Daten nur in anonymisierter Form analysiert werden, und die Resultate nur aggregiert kommuniziert werden, damit keine Rückschlüsse sowohl auf einzelne Versicherte, als auch auf Leistungserbringer möglich sind.
Der Datensatz enthält keine Informationen, welche eine Identifikation der individuellen Personen und Leistungserbringer zulassen. Jede der Beobachtungen beschreibt Stammdaten der Versicherten und aggregierte Kennzahlen für das Kalenderjahr 2015.

## Grundpopulation

Die Grundpopulation dieser Analyse sind die bei der Helsana-Gruppe in der OKP versicherten Personen. Das Versichertenkollektiv der Helsana-Gruppe weist ca. 15% der gesamten Schweizer Bevölkerung auf, in allen Regionen des Landes, und mit einer ähnlichen Verteilung bezüglich Alter und Geschlecht wie die gesamte Bevölkerung. Dieser hohe Anteil und die landesweite Verteilung der Versicherten sprechen dafür, dass die hier erzeugten Resultate auf die gesamte Schweizer Bevölkerung verallgemeinert werden können. Dagegen spricht, dass in dieser Analyse sehr unterschiedliche MC Modelle mit unterschiedlichen Einschränkungen gemeinsam untersucht werden, und weil sich die genaue Ausgestaltung dieser Modelle je nach Krankenversicherer unterscheidet.  
Zusätzlich ist zu beachten, dass die Resultate nicht auf die im Abschnitt "Ausschlüsse" beschriebenen Gruppen übertragbar sind.

### Stichprobe

Die Analyse basiert auf einer Stichprobe mit `r Format(nrow(ds), fmt = fmt.count)` Beobachtungen. Diese Beschränkung auf die Anzahl Personen in der Analyse wurde vorgenommen, um bezüglich des Treatments gleich grosse Gruppen aufzuweisen, und aus praktischen Gründen (Grösse des Datensatzes).   

### Ausschlüsse

Das Vesichertenkollektiv wurde auf Personen eingeschränkt, welche das gesamte Jahr 2015 eine OKP-Deckung aufgewiesen haben (damit immer ein ganzes Jahr an Leistungen in die Analyse eingeflossen ist). Personen, welche im Jahr 2015 verstorben sind, werden dadurch ausgeschlossen. Die Resultate können somit nicht auf die Situtation am Ende des Lebens übertragen werden.  

Nach einer ersten Analyse der Daten(Tabelle \ref{tab:tab.abstract}) wurden zudem Datensätze ausgeschlossen, welche fehlende Werte in den Variablen für die Anzahl chronische Erkranungen und/oder zu den Stammdaten ihres Wohnorts aufwiesen.  
Bei den Personen ohne die Angabe der Anzahl chronischer Erkrankungen handelt es sich um Bewohner von Langzeitpflegeeinrichtungen, bei denen der Medikamentenkonsum pauschal abgerechnet wird. Diese spezielle Untergruppe der Versicherten weist mutmasslich auch ein deutlich unterschiedliches Verhalten bezüglich der Zielgrösse Anzahl Arztbesuche auf, und ein Ausschluss ist damit sinnvoll, auch wenn die Resultate dann nicht auf diese Gruppe übertragen werden kann.  

Für den Umgang mit den fehlenden Werten zu den Stammdaten des Wohnorts (Stadt/Land und Grossregion) gäbe es andere Möglichkeiten, als den Ausschluss der Beobachtungen. Beispiele hierfür sind Einführung neuer Kategorien, oder Vorhersagemodelle für diese Grössen aufgrund der bekannten Einflussgrössen. Allerdings führte das Einführen neuer Kategorien in diesen beiden Variablen zu einem Kollaps in der Schätzfunktion des Regressionsmodells (aufrund von Kollinearität?) welcher nicht gelöst werden konnte, und ein separates Modell für diese Variablen hätte den Rahmen dieser Arbeit gesprengt. Da es sich nur um einen sehr geringen Prozentsatz der Beobachtungen handelt, kann ein Ausschluss dieser hingenommen werden.

Dadurch enthält der verwendete Datensatz insgesamt `r Format(nrow(ads.1.mod), fmt = fmt.count)` Beobachtungen.

## Beschreibung der Daten

In Tabelle \ref{tab:tab.abstract} ist eine kurze Beschreibung der im Datensatz enthaltenen Variablen zu finden, welche auch Informationen über fehlende Werte enthält. Wie bereits im Abschnitt "Ausschlüsse" erwähnt, wurden für alle weiteren Auswertungen die Beobachtungen mit fehlenden Wertden in mindestens einer Variablen ausgeschlossen.  
Die hier aufgeführten Variablen, sowie allfällige Ableitungen davon, stehen im Anschluss für die Modellierung zur Verfügung.

```{r tbl.abstract, echo=FALSE}
tbl.abstract <- Abstract(ads.1)

pander(tbl.abstract, caption = "\\label{tab:tab.abstract}Beschreibung der Variablen", justify = rep("left", ncol(tbl.abstract)))
```

Um einen ersten Überblick über die Daten zu erhalten, sind in univariate Analysen der einzelnen Variablen erstellt worden: numerische Variablen in Tabelle \ref{tbl.summary.num},  dichotome Variablen in Tabelle \ref{tbl.summary.2}, und die restlichen kategorialen Variablen in Tabelle \ref{tbl.summary.cat}.

```{r tbl.summary.num, echo=FALSE}
tbl.summary.num <- summary(ads.1.mod %>% select(valter_n, kons_n, pcg_n))

pander(tbl.summary.num, caption = "\\label{tbl.summary.num}Univariate Statistik der numerischen Variablen", justify = rep("left", ncol(tbl.summary.num)))
```

<!-- ```{r fig.kons, echo=FALSE, fig.cap="\\label{fig:fig.kons}Verteilung der Zielvariablen kons_n (Anzahl Kosultationen)"} -->
<!-- ads.1 %>%  -->
<!--   ggplot(aes(kons_n)) + geom_histogram() + theme_minimal() + labs(y = "Anzahl Konsultationen") -->
<!-- ``` -->


```{r tbl.summary.2, echo=FALSE}
tbl.summary.2 <- summary(ads.1.mod %>% select(sex_x, franch_elig_fg, okp_unfall_fg, mc_fg))

pander(tbl.summary.2, caption = "\\label{tbl.summary.2}Univariate Statistik der dichotomen Variablen", justify = rep("left", ncol(tbl.summary.2)))
```

```{r tbl.summary.cat, echo=FALSE}
tbl.summary.cat <- summary(ads.1.mod %>% select(sprgeb_red_x, stadtland_red_x, greg_x), maxsum = 10)

pander(tbl.summary.cat, caption = "\\label{tbl.summary.cat}Univariate Statistik der restlichen kategorialen Variablen", justify = rep("left", ncol(tbl.summary.cat)))
```


## Beschreibung der Baseline-Charakteristika

In Tabelle \ref{tbl.baseline} ist die Verteilung innerhalb der einzelnen Variablen in den beiden Gruppen mit (Treatmentgruppe) resp. ohne (Kontrollgruppe) MC Modell ersichtlich. Aufgrund der Ausschlüsse sind die beiden Gruppen nicht mehr exakt gleich gross (wie in der Stichprobenziehung ursprünglich vorgegeben), jedoch kann weiterhin von einem balancierten Design gesprochen werden.

```{r tbl.baseline ,echo=FALSE}
tbl.1 <- TOne(ads.1.mod %>% select(-mc_fg, -age_grp_x), grp = ads.1.mod$mc_fg,
              FUN = function(x) gettextf("%s / %s", Format(median(x, na.rm=TRUE), digits=1),
                                         Format(IQR(x, na.rm=TRUE), digits=1)))

tbl.1[,1] <- gsub(" ", "&nbsp;", tbl.1[,1], fixed=TRUE) # damit leading spaces bleiben!

kable(tbl.1, caption = "\\label{tbl.baseline}Baseline-Charakteristika, insgesamt und unterteilt in Treatment- resp. Kontrollgruppe (\"ja\" resp. \"nein\")")
```

Verwendete Tests: ') Kruskal-Wallis test, ") Fisher exact test, "") Chi-Square test  
P-Werte: [0, 0.001] = \***, (0.001, 0.01] = \**, (0.01, 0.05] = \*, (0.05, 0.1] = \., (0.1,1] =  
  
# Modelle

## Poisson Modell

Als erstes wird ein Poisson-Model erstellt, welches sämtliche zur Verfügung stehenden Prädiktoren beinhaltet.

```{r coef.poisson}
glm.poisson <- glm(formula = kons_n ~ ., data = ads.1.mod, family = "poisson")
# coef.poisson <- tidy(glm.poisson, exponentiate = TRUE, conf.int = FALSE, method = "Wald")
# pander(coef.poisson, caption = "Koeffizienten aus dem Poisson Modell", justify = c("left"))
```

```{r sum.poisson}
sum.poisson <- glance(glm.poisson)
pander(sum.poisson, caption = "Modell-Parameter aus dem Poisson Modell")
```
  
Ein Test auf over-dispersion zeigt, dass das Poisson-Modell schlecht an die Daten angepasst ist (Tabelle \ref{tab:test.over.dispersion}), der entsprechende $Chi^2$-Test weist einen p-Wert von 0 auf.  

```{r test.over.dispersion}
test.disp <- with(glm.poisson, cbind(res.deviance = deviance, df = df.residual,
  p = pchisq(deviance, df.residual, lower.tail=FALSE)))
kable(test.disp, caption = "\\label{tab:test.over.dispersion}Test auf over-dispersion")
```

Over-dispersion bedeutet, dass die Zielvariable `kons_n` auch innerhalb der Stufen der Prädiktoren stark streut. Dadurch wird die Annahme des Poisson-Modells, dass `Var(Y) = E(Y)`, verletzt. Aus diesem Grund wird in der Folge anstelle eines Poisson-Models das negativ-binomiale Modell verwendet, welches einen Parameter für die Dispersion schätzt.

## Negativ-binomiale Modelle

### Variablenselektion

In Tabelle \ref{tab:lrt.negbin.crude} wird pro Prädiktor das Ergebnis eines Likelihood-Ratio Tests von Modellen mit jeweils nur diesem Prädiktor angezeigt. Der Test ist abgesehen von `sprgeb_red_x` für alle Prädiktoren signifikant.  

```{r lrt.negbin.crude, echo=FALSE}
glm.mc <- glm.nb(formula = kons_n ~ mc_fg, data = ads.1.mod)
p.all <- anova(glm.mc, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL")
glm.sex <- glm.nb(formula = kons_n ~ sex_x, data = ads.1.mod)
p.all <- rbind(p.all, p.all <- anova(glm.sex, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL"))
glm.age <- glm.nb(formula = kons_n ~ valter_n, data = ads.1.mod)
p.all <- rbind(p.all, p.all <- anova(glm.age, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL"))
glm.franch <- glm.nb(formula = kons_n ~ franch_elig_fg, data = ads.1.mod)
p.all <- rbind(p.all, p.all <- anova(glm.franch, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL"))
glm.unfall <- glm.nb(formula = kons_n ~ okp_unfall_fg, data = ads.1.mod)
p.all <- rbind(p.all, p.all <- anova(glm.unfall, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL"))
glm.spr <- glm.nb(formula = kons_n ~ sprgeb_red_x, data = ads.1.mod)
p.all <- rbind(p.all, p.all <- anova(glm.spr, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL"))
glm.stadt <- glm.nb(formula = kons_n ~ stadtland_red_x, data = ads.1.mod)
p.all <- rbind(p.all, p.all <- anova(glm.stadt, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL"))
glm.greg <- glm.nb(formula = kons_n ~ greg_x, data = ads.1.mod)
p.all <- rbind(p.all, p.all <- anova(glm.greg, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL"))
glm.pcg <- glm.nb(formula = kons_n ~ pcg_n, data = ads.1.mod)
p.all <- rbind(p.all, p.all <- anova(glm.pcg, test = "LRT") %>% rownames_to_column() %>% filter(rowname != "NULL"))

pander(p.all, caption = "\\label{tab:lrt.negbin.crude}Likelihood-Ratio Test für alle Prädiktoren einzeln", justify = c("left"))
```

Aus diesem Grund wird getestet, ob ein Modell mit `sprgeb_red_x` sich signifikant von einem ohne diesem Prädiktor unterscheidet, falls alle anderen Prädiktoren im Modell sind (Tabelle \ref{tab:lrt.negbin.spr}). Der Test zeigt, dass sich die beiden Modelle (mit resp. ohne `sprgeb_red_x`) nicht signifikant voneinander unterscheiden. Als Folge wird auf den Prädiktor `sprgeb_red_x` verzichtet.

```{r lrt.negbin.spr, echo=FALSE}
glm.negbin.all <- glm.nb(formula = kons_n ~ ., data = ads.1.mod)
glm.negbin.red <- update(glm.negbin.all, . ~ . - sprgeb_red_x)
pander(anova(glm.negbin.all, glm.negbin.red), caption = "\\label{tab:lrt.negbin.spr}Likelihood-Ratio Test mit resp. ohne den Prädiktor `sprgeb_red_x`")
```

### Berücksichtigung numerischer Variablen

Die beiden numerischen Prädiktoren Alter (`valter_n`) und Anzahl chronische Erkrankungen (`pcg_n`) haben gemäss dem Likelihood-Ratio Test einen signifikanten Einfluss auf die Zielvariable Anzahl Konsultationen (`kons_n`). Bei numerischen Variablen ist allerdings fraglich, ob die Annahme eines linearen Zusammenhangs korrekt ist. Deshalb wird nacheinander für beide dieser Prädiktoren getestet, ob die Hinzunahme der quadrierten Terme dieser Prädiktoren das Modell besser macht.

#### Quadratischer Term für Alter

In Tabelle \ref{tab:lrt.negbin.age} ist ersichtlich, dass der kategoriale Term für den Prädiktor Altersgruppe das Modell nicht verbessert.

```{r lrt.negbin.age, echo=FALSE}
glm.negbin.age <- glm.nb(formula = kons_n ~ valter_n, data = ads.1.mod)
# glm.negbin.age2 <- update(glm.negbin.age, . ~ . + I(valter_n^2))
glm.negbin.agegrp <- glm.nb(formula = kons_n ~ age_grp_x, data = ads.1.mod)
pander(anova(glm.negbin.age, glm.negbin.agegrp), caption = "\\label{tab:lrt.negbin.age}Likelihood-Ratio Test mit kontinuierlicher Variable Alter resp. kategorialem Term für die Altersgruppe")
```

#### Quadratischer Term für Anzahl chronischer Erkrankungen

In Tabelle \ref{tab:lrt.negbin.pcg} ist ersichtlich, dass der quadratische Term für den Prädiktor Anzahl chronischer Erkrankungen das Modell verbessert.

```{r lrt.negbin.pcg, echo=FALSE}
glm.negbin.pcg <- glm.nb(formula = kons_n ~ pcg_n, data = ads.1.mod)
glm.negbin.pcg2 <- update(glm.negbin.pcg, . ~ . + I(pcg_n^2))
pander(anova(glm.negbin.pcg, glm.negbin.pcg2), caption = "\\label{tab:lrt.negbin.pcg}Likelihood-Ratio Test mit resp. ohne quadratischem Term für den Prädiktor `pcg_n`")
```

### Effektmodifikation/Interaktionen

Als potentieller Effektmodifikator wird die Farnchisestufe verwendet. Es soll untersucht werden, ob die Restriktionen in einem Managed-Care Modell sowohl bei tiefen als auch bei hohen Franchisen einen Effekt zur Folge haben. Hierzu wird die Modellformel um den Interaktionsterm `mc_fg*franch_elig_fg` erweitert.

```{r, eval=FALSE}
glm.nb(formula = update(formula(glm.negbin.all), . ~ . + mc_fg*franch_elig_fg), data = ads.1.mod)
```

Mit Hilfe eines Likelyhood-Ratio Tests wird überprüft, ob der Interaktionsterm `mc_fg*franch_elig_fg` zu einem signifikant unterschiedlichen Modell führt, und der Term somit im Modell verbleiben soll.

```{r lrt.negbin.int, echo=FALSE}
glm.negbin.noint <-glm.nb(formula = kons_n ~ mc_fg + sex_x + valter_n + franch_elig_fg + okp_unfall_fg + 
                            stadtland_red_x + greg_x + pcg_n + I(pcg_n^2), data = ads.1.mod)
glm.negbin.int <- update(glm.negbin.all, . ~ . - mc_fg*franch_elig_fg)
pander(anova(glm.negbin.noint, glm.negbin.int), caption = "\\label{tab:lrt.negbin.spr}Likelihood-Ratio Test mit resp. Interaktionsterm `mc_fg*frach_elig_fg`")
```

## Verwendetes Modell

```{r coef.nb.final}
glm.negbin.final <- glm.nb(formula = kons_n ~ mc_fg + sex_x + valter_n + age_grp_x + franch_elig_fg + okp_unfall_fg + 
                            stadtland_red_x + greg_x + pcg_n + I(pcg_n^2) + mc_fg*franch_elig_fg, data = ads.1.mod)
coef.nb.final <- tidy(glm.negbin.final, exponentiate = TRUE, conf.int = FALSE, method = "Wald")
pander(coef.nb.final, caption = "Koeffizienten aus dem finalen Modell")
```


```{r sum.nb.final}
sum.nb.final <- glance(glm.negbin.final)
pander(sum.nb.final, caption = "Modell-Parameter aus dem negativ-binomialen Modell")
```

Autor: Beat Brüngger  
Datum: 16.2.2016

# Bibliographie

